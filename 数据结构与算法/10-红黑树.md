# 红黑树

> 更新时间：2019-04-08

红黑树是平衡二叉树的经典代表，红黑树是最难的数据结构之一。数据的操作都是O(logn),我们要掌握它的用法和使用场景，用它来解决问题，JDK8的HashMap也用到了红黑树

### 什么是平衡二叉树
二叉树中的任意一个节点的左右子树高度相差不能大于1，这个平衡其实就是要让一棵二叉树开起来是对称的，不能一边倒
```
       是                      不是
        o                       o
      /   \                      \
    o       o                      o
  /   \                             \
o      o                              o
```

### 什么是红黑树
Red-Black Tree简称R-B Tree，有以下特点：
1. 任何节点都有颜色，红色或黑色
2. 根节点是黑色的
3. 父子节点之间不能出现两个连续的红节点
4. 任何节点向下遍历到其子孙叶子节点，所经过的黑节点个数必须相等
5. 空节点被认为是黑色的

红黑树是为了解决二叉查找树平衡问题(退化成单链表)

一棵经典的红黑树（o表示红，x表示黑）
```
                        x
                      /   \
                    o       o
                  /   \   /   \
                x      x x      x 
              /  \    / \ \    /  \
            x     o  x   x x  o    o
                /   \       /   \ /  \
              x       x    x     xx    x
```

### 平衡调整
当一棵红黑树发生增删时，可能不是一棵红黑树了，这是就要进行调整，调整一般可以用变色和旋转的方法进行

##### 变色
为了满足红黑树的特点，需要对节点变颜色，也就是红色变黑色，黑色变红色，也就是说颜色是为了平衡而生的

##### 右旋
以X节点为支点旋转，它的右子节点Y变成了父节点，它的左子节点A不变，还是跟着，右子节点Y的右子节点R不变，右子节点Y的左子节点B变成了X的右子节点
```
        |        ->         |
        X                   Y
      /   \               /   \
    A      Y            X       R
         /   \        /   \
        B     R     A      B
```

##### 左旋
以X节点为支点旋转，它的左子节点Y变成了父节点，右子节点R不变，左子节点Y的左子节点A不变，左子节点Y的右子节点变成了X
```
        |        ->         |
        X                   Y
      /   \               /   \
    Y      R             A      X
  /   \                        /  \
 A     B                      B    R
```

### 插入
红黑树规定插入的节点必须是红色的。因此，如果
1. 插入节点的父节点是黑色的，那我们什么都不用做
2. 如果插入的节点是根节点，那我们直接将它变成黑色的

### 红黑树的平衡调整
红黑树的平衡调整跟拼魔法是一样的，就那么几种情况，根据不同的情况，依次调整就可以，跟还原魔法一样